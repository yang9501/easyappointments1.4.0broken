$(document).ready(function(){function e(e){try{if(e.error)throw new Error("Could not authorize user.");var a=GlobalVariables.appointmentData;a.start_datetime=GeneralFunctions.ISODateString(Date.parseExact(a.start_datetime,"yyyy-MM-dd HH:mm:ss")),a.end_datetime=GeneralFunctions.ISODateString(Date.parseExact(a.end_datetime,"yyyy-MM-dd HH:mm:ss"));var t={summary:GlobalVariables.serviceData.name,location:GlobalVariables.companyName,start:{dateTime:a.start_datetime},end:{dateTime:a.end_datetime},attendees:[{email:GlobalVariables.providerData.email,displayName:GlobalVariables.providerData.first_name+" "+GlobalVariables.providerData.last_name}]};gapi.client.load("calendar","v3",function(){gapi.client.calendar.events.insert({calendarId:"primary",resource:t}).execute(function(e){if(e.error)throw new Error("Could not add the event to Google Calendar.");$("#success-frame").append($("<br/>"),$("<div/>",{class:"alert alert-success col-xs-12",html:[$("<h4/>",{text:EALang.success}),$("<p/>",{text:EALang.appointment_added_to_google_calendar}),$("<a/>",{href:e.htmlLink,text:EALang.view_appointment_in_google_calendar})]})),$("#add-to-google-calendar").hide()})})}catch(e){$("#success-frame").append($("<br/>"),$("<div/>",{class:"alert alert-danger col-xs-12",html:[$("<h4/>",{text:EALang.oops_something_went_wrong}),$("<p/>",{text:EALang.could_not_add_to_google_calendar}),$("<pre/>",{text:e.message})]}))}}$("#add-to-google-calendar").on("click",function(){gapi.client.setApiKey(GlobalVariables.googleApiKey),gapi.auth.authorize({client_id:GlobalVariables.googleClientId,scope:GlobalVariables.googleApiScope,immediate:!1},e)})});